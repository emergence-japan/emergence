<!DOCTYPE html>
<html>
<body>
  <h2>GAS 疎通テスト</h2>
  <p>1. GASのURLをここに貼る:</p>
  <input type="text" id="url" style="width: 100%;" placeholder="https://script.google.com/macros/s/.../exec">
  
  <p>2. 名前を入力:</p>
  <input type="text" id="name" value="テスト太郎">
  
  <p>3. 送信ボタンを押す:</p>
  <button onclick="send()">テスト送信</button>

  <p id="result"></p>

  <script>
    async function send() {
      const url = document.getElementById('url').value;
      const name = document.getElementById('name').value;
      const res = document.getElementById('result');
      
      res.innerText = "送信中...";
      
      try {
        const params = new URLSearchParams();
        params.append('name', name);
        params.append('inquiryType', 'test');
        params.append('message', 'これはPCからの直接テストです');

        await fetch(url, {
          method: 'POST',
          mode: 'no-cors',
          body: params
        });
        
        res.innerText = "送信完了！スプレッドシートを確認してください。";
      } catch (e) {
        res.innerText = "エラー: " + e.message;
      }
    }
  </script>
</body>
</html>
